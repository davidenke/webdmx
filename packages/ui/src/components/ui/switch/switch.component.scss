:host {
  // public api
  ---webdmx-switch-knob-size: var(--webdmx-switch-knob-size, 20px);
  ---webdmx-switch-label-gap: var(--webdmx-switch-label-gap, 0.75em);

  // deferred properties based on public api
  ---webdmx-switch-border-width: calc(var(---webdmx-switch-knob-size) / 10);
  ---webdmx-switch-font-size: calc(var(---webdmx-switch-knob-size) / 2);
  ---webdmx-switch-knob-from: 0%;
  ---webdmx-switch-knob-to: calc(100% - var(---webdmx-switch-knob-size));
  ---webdmx-switch-padding: calc(var(---webdmx-switch-label-gap) + var(---webdmx-switch-knob-size));
}

// compensate the outline
// stylelint-disable-next-line no-duplicate-selectors
:host {
  display: inline-block;
  padding: var(---webdmx-switch-border-width);
}

// the wrapper around everything -
// usually this should be the host itself, but for convenience a label element is used
// and the associated input element is used as knob
label {
  position: relative;

  display: grid;
  grid-template: 'off on' auto;
  overflow: hidden;

  border-radius: var(---webdmx-switch-knob-size);
  outline: var(---webdmx-switch-border-width) solid var(--webdmx-color-grey-70);

  transition: grid-template-columns 0.2s ease-in-out;

  user-select: none;

  :host([disabled]) & {
    opacity: 0.5;
  }

  :host(:not([disabled])) {
    cursor: pointer;
  }

  :host([active]) & {
    grid-template-columns: 1fr 0fr;
  }

  :host(:not([active])) & {
    grid-template-columns: 0fr 1fr;
  }
}

// the knob
input {
  all: unset;

  position: absolute;

  display: block;
  width: var(---webdmx-switch-knob-size);

  background-color: var(--webdmx-color-grey-90);
  border-radius: 50%;
  outline: var(---webdmx-switch-border-width) solid var(--webdmx-color-grey-70);

  transition: left 0.2s ease-in-out;

  content: '';
  inset: 0 auto;
  aspect-ratio: 1 / 1;

  :host([active]) & {
    left: var(---webdmx-switch-knob-to);
  }

  :host(:not([active])) & {
    left: var(---webdmx-switch-knob-from);
  }
}

// the labels (on and off)
slot {
  display: block;

  overflow: hidden;

  font-size: var(---webdmx-switch-font-size);
  line-height: var(---webdmx-switch-knob-size);
  letter-spacing: 0.1em;
  white-space: nowrap;
  text-align: center;
  text-transform: uppercase;

  transition: 0.2s ease-in-out;
  transition-property: padding-left, padding-right;

  &[name='off'] {
    grid-area: off;

    color: var(--webdmx-color-grey-90);

    background-color: var(--webdmx-color-grey-20);

    :host(:not([active])) & {
      visibility: hidden;
    }

    :host([active]) & {
      padding: 0 var(---webdmx-switch-padding) 0 var(---webdmx-switch-label-gap);
    }
  }

  &[name='on'] {
    grid-area: on;

    color: var(--webdmx-color-grey-35);

    background-color: var(--webdmx-color-grey-100);

    :host(:not([active])) & {
      padding: 0 var(---webdmx-switch-label-gap) 0 var(---webdmx-switch-padding);
    }

    :host([active]) & {
      visibility: hidden;
    }
  }
}
